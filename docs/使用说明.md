# 使用说明

本文档说明本项目中各页面的功能与使用方法。

---

## 首页

- **入口**：`index.html`，开发时访问 `http://localhost:5173/`。
- **内容**：标题「Shader 调试器」与导航链接：
  - [Halftone 预设示例](/halftone-preset.html)
  - [Shader 调试](/shader-debug.html)
- **脚本**：`src/pages/home.ts` 仅负责静态展示，无额外逻辑。

---

## Halftone 预设示例页

- **入口**：`halftone-preset.html`，开发时访问 `http://localhost:5173/halftone-preset.html`。
- **用途**：单画布 + Tweakpane 面板，用于快速体验 Halftone 半调效果与调参。
- **功能**：
  - **画布**：显示当前阶段（原图 / SAT / Pass1 / 最终）的渲染结果。
  - **面板**：右侧参数面板（Tweakpane），可调节 n、threshold、对比度、颜色等；支持上传图片。
  - **阶段切换**：在面板或控件中选择查看阶段。
- **使用**：拖动滑竿、颜色等参数即可看到画面实时变化；点击上传按钮可更换输入图。

---

## Shader 调试页

- **入口**：`shader-debug.html`，开发时访问 `http://localhost:5173/shader-debug.html`。
- **用途**：多阶段管线预览 + 时间轴动画 + 预设保存/加载，用于调试 Shader 与关键帧。

### 管线预览

- **布局**：上方为管线卡片区域，从左到右依次为：**原图 → SAT (CPU) → Pass1 → Pass2**。
- **操作**：
  - **Reload Shaders**：重新从 `public/shaders/` 拉取并编译着色器，修改 `.vert`/`.frag` 后点击即可生效。
  - **上传图片**：通过管线卡片或全局的上传入口更换输入图。
- **阶段**：每个阶段一张卡片，显示该阶段输出；部分卡片支持通道遮罩、范围映射等（若 UI 提供）。

### 时间轴

- **位置**：管线下方「时间轴」卡片内，包含工具栏与轨道区。
- **工具栏**：
  - **播放 / 暂停**：控制时间轴播放。
  - **上一帧 / 下一帧**：按帧步进。
  - **跳到开始**：当前时间归零。
  - **吸附**：下拉选择「无 / 1 / 0.5 / 0.1」，播放头与设置时间会吸附到对应网格。
  - **添加关键帧**：在当前时间为所有「已改变」参数添加关键帧。
  - **时间显示**：当前时间 / 总时长（秒）。
- **轨道与关键帧**：
  - 将左侧参数卡片的**参数标题**拖拽到时间轴区域，可新增该参数的轨道。
  - 点击轨道可打开右侧关键帧编辑面板：查看/编辑关键帧**值**（时间仅展示），添加/删除关键帧。
  - 播放时，时间轴会按当前时间插值并写回参数，参数控件会同步更新；若某参数当前值与时间轴插值不一致，该控件会高亮（如黄色背景）。
- **加载**：选择预设名称后需点击「加载」才会将预设应用到时间轴；仅在下拉中选名称不会自动加载。

### 预设

- **输入框**：可输入预设名称，或点击「▼」从已有预设列表中选择名称（选中的只是填入名称，不会自动加载）。
- **加载**：按输入框中的名称查找预设，找到则加载到时间轴；未找到会提示。
- **保存**：将当前时间轴状态保存到输入框中的名称：若该名称已存在则覆盖，否则新建预设。
- **存储位置**：
  - **开发环境**（`npm run dev`）：保存时会写入项目内 `public/presets.json`，页面加载时优先从该文件读取。
  - **其他环境**：无写文件接口，预设仅保存在浏览器 localStorage 中。
- 重命名：在输入框中改为新名称后点击「保存」即可（相当于另存为新名）。

详细的数据结构与 API 约定见 [时间轴与预设](时间轴与预设.md)、[预设文件与 API](预设文件与API.md)。

---

## 作为插件使用

在 Next.js 或其他宿主中挂载 Shader 调试 UI 的方式见项目根目录 [README.md](../README.md) 中「作为 Next.js 插件使用」一节。
